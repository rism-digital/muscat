ids = %w(
993121202
993121647
100031298
100031450
100031840
100031013
100031060
100031217
100031218
100031230
100031231
100031312
100031399
100031402
100031431
100031432
100031433
100031492
100031575
100031576
100031577
100031578
100031579
100031580
100031581
100031733
100031734
100031735
100031736
100031737
100031738
100031739
100031740
100031741
100031742
100031743
100031744
100031745
100031746
100031747
100031748
100031749
100031750
100031751
100031752
100031753
100031754
100031755
100031756
100031757
100031758
100031759
100031760
100031761
100031762
100031763
100031764
100031765
100031766
100031767
100031768
100031769
100031770
100031771
100031772
100031773
100031774
100031775
100031776
100031777
100031778
100031779
100031780
100031781
100031782
100031783
100031784
100031785
100031786
100031787
100031788
100031789
100031790
100031791
100031792
100031793
100031794
100031795
100031796
100031797
100031798
100031799
100031800
100031801
100031802
100031803
100031804
100031805
100031806
100031807
100031808
100031809
100031810
100031811
100031812
100031813
100031814
100031815
100031816
100031817
100031818
100031819
100031820
100031821
100031822
100031823
100031824
100031825
100031826
100031827
100031828
100031829
100031830
100031831
100031832
100031833
100031834
100031835
100031836
100031837
100031838
100031839
100031841
100031842
100031843
100031844
100031845
100031846
100031847
100031848
100031849
100031850
100031851
100031852
100031853
100031854
100031855
100031856
100031857
100031858
100031859
100031860
100031861
100031862
100031863
100031864
100031865
100031866
100031867
100031868
100031869
100031870
100031871
100031872
100031873
100031874
100031875
100031876
100031877
100031878
100031879
100031880
458001400
458001401
458001402
458001403
458001404
458001405
458001406
458001407
458001408
458001696
458001697
458001698
458001699
458001700
458001701
458001702
458001703
458001704
458001705
458001706
458001707
458001708
458001710
458001711
458001712
458001713
458001714
458001715
458001716
458001717
458001718
458001719
458001720
458001721
458001727
458001728
458001729
458001730
458001731
458001732
458001733
458001734
458001735
458001736
458001737
458001738
458001739
458001740
458001741
458001742
458001745
458001746
458001748
458001749
458001750
458001751
458001753
458001754
458001755
458001756
458001757
458001762
458001763
458001765
458001766
458001767
458001768
458001769
458001770
458001771
458001772
458001773
458001774
458001775
458001776
458001777
458001778
458001779
458001780
458001781
458001782
458001783
458001784
458001785
458001786
458001787
458001788
458001789
458001790
458001791
458001792
458001793
458001794
458001795
458001796
458001797
458001798
458001799
458001800
458001801
458001802
458001803
458001804
458001805
458001806
458001807
458001808
458001809
458001810
458001811
458001812
458001813
458001814
458001815
458001816
458001817
458001818
458001819
458001820
458001821
458001822
458001823
458001824
458001825
458001826
458001827
458001828
458001829
458001830
458001831
458001832
458001833
458001834
458001835
458001836
458001837
458001838
458001839
458001840
458001841
458001842
458001843
458001844
458001844
458001845
458001845
458001846
458001847
458001848
458001849
458001850
458001851
458001852
458001853
458001854
458001855
458001856
458001857
458001858
458001859
458001860
458001861
458001862
458001863
458001864
458001865
458001866
458001869
458001870
458001871
458001872
458001873
458001874
458001875
458001876
458001877
458001879
458001890
458001892
458001893
458001894
458001895
458001896
458001897
458001898
458001899
458001900
458001904
458001906
458001908
458001909
458001910
458001911
458001912
458001913
458001914
458001915
458001916
458001917
458001918
458001919
458001920
458001920
458001921
458001922
458001923
458001924
458001925
458001926
458001927
458001928
458001929
458001930
458001931
458001932
458001933
458001934
458001935
458001936
458001937
458001938
458001939
458001940
458001941
458001942
458001943
458001944
458001945
458001946
458001947
458001948
458001949
458001950
458001951
458001952
458001953
458001954
458001955
458001956
458001957
458001958
458001959
458001960
458001961
458001962
458001963
458001964
458001965
458001966
458001967
458001968
458001970
458001972
458001973
458001974
458001975
458001976
458001977
458001978
458001979
458001980
458001981
458001982
458001983
458001984
458001985
458001987
458001988
458001989
458001990
458001990
458001991
458001992
458001993
458001994
458001995
458001996
458001997
458001998
458001999
458002000
458002001
458002002
458002003
458002004
458002005
458002006
458002008
458002009
458002010
458002011
458002012
458002013
458002014
458002015
458002016
458002017
458002018
458002019
458002020
458002021
458002022
458002024
458002025
458002026
458002027
458002028
458002029
458002030
458002031
458002032
458002033
458002034
458002035
458002036
458002037
458002038
458002039
458002040
458002041
458002045
458002046
458002047
458002048
458002049
458002050
458002051
458001409
458001410
458001411
458001412
458001413
458001414
458001415
458001416
458001417
458001418
458001419
458001420
458001421
458001422
458001423
458001424
458001425
458001426
458001427
458001428
458001429
458001430
458001431
458001432
458001433
458001434
458001435
458001436
458001437
458001438
458001439
458001440
458001441
458001442
458001443
458001444
458001445
458001446
458001447
458001448
458001449
458001450
458001451
458001452
458001453
458001454
458001455
458001459
458001460
458001461
458001462
458001463
458001464
458001465
458001466
458001467
458001468
458001469
458001470
458001471
458001472
458001473
458001474
458001475
458001476
458001479
458001480
458001481
458001482
458001483
458001484
458001485
458001486
458001487
458001488
458001489
458001490
458001491
458001492
458001493
458001494
458001495
458001496
458001497
458001498
458001499
458001500
458001501
458001502
458001503
458001504
458001505
458001506
458001507
458001508
458001509
458001510
458001511
458001512
458001513
458001514
458001515
458001516
458001518
458001519
458001520
458001521
458001526
458001527
458001528
458001529
458001531
458001532
458001533
458001534
458001535
458001536
458001537
458001538
458001539
458001540
458001541
458001542
458001543
458001544
458001545
458001546
458001547
458001548
458001549
458001555
458001556
458001557
458001558
458001559
458001560
458001561
458001562
458001563
458001564
458001565
458001566
458001567
458001567
458001568
458001568
458001569
458001570
458001571
458001572
458001573
458001574
458001575
458001577
458001578
458001579
458001587
458001588
458001589
458001590
458001594
458001595
458001596
458001597
458001598
458001599
458001600
458001606
458001607
458001608
458001609
458001610
458001611
458001612
458001613
458001614
458001615
458001616
458001617
458001618
458001619
458001620
458001621
458001622
458001623
458001624
458001625
458001626
458001627
458001628
458001629
458001630
458001631
458001632
458001633
458001634
458001635
458001636
458001637
458001638
458001639
458001640
458001641
458001642
458001645
458001646
458001647
458001648
458001649
458001651
458001652
458001653
458001654
458001654
458001656
458001657
458001661
458001667
458001668
458001669
458001670
458001671
458001674
458001675
458001676
458001677
458001678
458001679
458001680
458001681
458001695
)

group_me = ["593", "260", "300", "590", "340", "028", "592", "563"]

ids.each do |id|
    s = Source.find(id)

    grouped = []

    puts "processing #{s.id}"
    group_me.each do |the_tag|
        s.marc.each_by_tag(the_tag) do |t|
            teight = t.fetch_first_by_tag("8")
            next if teight && teight.content
            t.add_at(MarcNode.new("source", "8", "01", nil), 0 )
            t.sort_alphabetically
            grouped << the_tag
        end
    end

    s.paper_trail_event = "Group tags " + grouped.sort.uniq.join(", ")
    s.save
end