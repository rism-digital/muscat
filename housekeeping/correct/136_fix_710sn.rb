no_add = %w(
991009993
990013012
990013014
990016916
990021086
990021093
990012994
990013033
990056866
990022231
990041720
990008583
990057179
990057180
990060907
990060915
990060908
990060911
990060912
990010289
990010317
992005436
990042730
991003809
992007119
990013556
990004150
990004202
990038080
990064304
990030432
990008231
990047738
990048230
990037317
990002955
990056847
990037352
990052680
990021407
991003910
990048229
991005950
990027215
990072880
990009603
990015015
990049923
990015555
992006205
1000000173
991011941
992005923
991012499
990008725
990008747
990008762
990008763
990008889
990004282
990015519
990060774
990035695
990022878
990021207
990058600
990032940
990037147
990055214
990004294
990069800
990048904
991001861
990008597
990015503
990036198
990001914
990037497
990037566
990009392
990009558
990009571
991014773
990036020
991016441
991016443
990056253
990011401
990011337
990011365
990053801
990011633
990041170
990049139
990059969
990070312
990008782
990008746
990049138
990064110
990064097
990071542
990026232
990004224
990004222
990004223
990012940
990012941
990012957
990016873
990013072
991023982
990072701
990004297
990013481
990013482
990013543
990013629
990013291
990014040
990014054
990014041
990013973
990065066
990055164
990070483
990041495
990031555
991010782
991010743
991010744
991010745
991010746
990060759
990008111
990008174
990009404
990009405
990009409
990008115
990008129
990008145
990009497
990008097
990011618
990060680
990060681
990012946
990015224
990060695
990022149
990022657
990010748
990066426
990020819
991019264
990059932
991013615
1001337446
990034262
990054869
990008811
990008812
990025664
990056890
990060749
990014059
990049804
990007016
990053005
990033909
991009655
990043541
990027211
990027214
990027431
990032958
990052951
990064370
990060918
991015232
990069718
990036252
990060672
990016924
990049981
990065815
990016786
990055928
990045343
990035723
990068292
990071615
990035760
990054239
990009758
990009952
990062708
990055348
991003091
990046417
990067842
990038893
990026319
991020101
990014053
990041734
990046415
990008581
990008586
990008587
990008575
990052977
990060756
990060760
990060761
990060763
990060765
990060767
990060769
990060771
990060772
990004315
990008577
990008598
990019689
990018207
990027439
990027945
990060758
990060835
990068228
990049632
990027622
990060731
990060750
990060752
990060754
991013367
991018434
990064690
990036084
990036080
990036096
990036087
990036083
990036106
990036112
990036095
990036098
990036100
990036114
990006356
990015650
990009351
990009354
990060097
990036055
990008412
990048944
991002880
992006355
990037341
990037331
990037423
990015064
990008193
990009403
990009386
990066456
991016439
991016442
991016444
990047323
992002300
992002301
992002302
992002303
992002299
990071103
990040063
990040064
990055418
990009396
990009391
990041314
990041315
990013636
990013638
990041677
990035961
992005362
990045266
990054170
990003452
990003451
990026710
990026713
990026717
990026718
990026719
990045177
990044745
990045421
990045453
990054175
990026714
990026698
990026699
990026701
990028851
990049972
990064173
991014400
990047091
990008787
990013948
990006487
990004151
990011226
991008473
990049658
990036043
990036045
990036065
990036060
990036061
990071477
990000413
990040606
990038511
990038510
990053669
991010383
990049645
990048735
990008391
990022576
990037774
990060281
990006374
990060775
990060776
990060777
991002902
990060227
991018967
990009187
991015882
990047775
990047980
991008834
990044465
990067229
990026385
990035846
991005886
990032174
990032194
990032195
990032196
990032198
990032199
990071086
)

ugo = Institution.find(40009305).referring_sources

#multiple 260 but all sn
#990038359
#990052757
#992007178

m = []
ugo.each do |s|
  
  next if no_add.include?(s.id.to_s)

  #s.marc["700"].each do |t|
  #  puts s.id if t["4"].first.content == "prt" || t["4"].first.content == "pub"
  #end

  s.marc["260"].each do |t|
    if t["b"].count == 0
      t.add_at(MarcNode.new("source", "b", "[s.n.]", nil), 0 )
    else
      t["b"].first.content = "[s.n.]"
    end

    if t["c"].count == 0
      t.add_at(MarcNode.new("source", "c", "[s.d.]", nil), 0 )
    end

    t.sort_alphabetically
  end

  if s.marc["260"].count == 0
    s.marc.add_tag_with_subfields("260", b: "[s.n.]", c: "[s.d.]")
  end

  # now nuke the 710
  s.marc["710"].each do |t|
    t.destroy_yourself if t["0"].first.content.to_s == "40009305"
  end

puts s.marc
puts

puts s.id if s.marc["260"].count > 1

end

#ap m.compact.sort.uniq

#skip = [990036198, 992007119]