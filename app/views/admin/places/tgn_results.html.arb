columns do
  column do
    panel "TGN Results" do
      if results.is_a? Array and results.size > 0
        table_for results.map do
          column ("Subject") {|row| row[:subject]}
          column ("Term") {|row| row[:term] }
          column ("Description") {|row| row[:description] }
          column ("Type") {|row| row[:type] }
          column ("Parents") {|row| row[:parents] }
          column ("In Muscat") {|row| row[:in_muscat] }
          column ("") {|row| 
            if row[:in_muscat]
              ""
            else
              link_to("Pull", "new?tgn_id=#{row[:subject]}")
            end
            }
        end
      else
        text_node("The selected query returned no results")
      end
    end
  end
end